â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
              âœ… ZIP CRACKER - UPGRADED TO MATCH REFERENCE SCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ‰ COMPLETE FEATURE PARITY WITH REFERENCE SCRIPT + TELEGRAM INTEGRATION!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… FEATURES IMPLEMENTED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. EXACT THREADING BEHAVIOR
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Uses threading.Thread and threading.Event
   âœ“ self.stop_event controls everything
   âœ“ Progress thread runs show_progress()
   âœ“ Main thread brute-forces passwords
   âœ“ Clean thread termination with join()
   âœ“ Daemon thread for safety

2. REAL-TIME PROGRESS TRACKING
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Tracks attempts count
   âœ“ Tracks elapsed time
   âœ“ Calculates attempts per second
   âœ“ Updates every 0.5 seconds internally
   âœ“ Sends to Telegram every 2.5 seconds

   Format (matches reference):
   "[+] Attempts: X | Time: Ys | Speed: Z pwd/s"

3. PYZIPPER INTEGRATION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Uses pyzipper.AESZipFile
   âœ“ Iterates wordlist line by line
   âœ“ Tests password with testzip()
   âœ“ Stops immediately when found
   âœ“ Closes ZIP file safely

4. TELEGRAM ADAPTATION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Progress updates sent to user
   âœ“ Success message with password
   âœ“ Failure message if not found
   âœ“ Error messages for missing files
   âœ“ Non-blocking with asyncio.run_in_executor()

5. FILE UPLOAD BEHAVIOR
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ /zip_crack â†’ bot requests ZIP upload
   âœ“ User uploads â†’ saved to results/<chat_id>/zip/
   âœ“ Cracking starts automatically

6. AUTOMATIC WORDLIST SELECTION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Default: Uses largest wordlist
   âœ“ /zip_crack small â†’ smallest wordlist
   âœ“ /zip_crack medium â†’ medium wordlist
   âœ“ /zip_crack big â†’ largest wordlist

7. STATISTICS & REPORTING
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Attempts count
   âœ“ Time elapsed
   âœ“ Speed (passwords/second)
   âœ“ Found password (if successful)
   âœ“ Extraction path
   âœ“ Report saved to zipcrack_report_TIMESTAMP.txt

8. SAFETY WARNING
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Every crack starts with:
     "âš ï¸ This ZIP cracking feature is for educational cybersecurity 
      training only, and may only be used on files you own."

9. NO SIMULATION
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   âœ“ Real password testing
   âœ“ Real ZIP extraction
   âœ“ Real statistics

10. CLEAN OUTPUT
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    âœ“ Report saved to results/<chat_id>/zipcrack_report.txt
    âœ“ Extracted files in results/<chat_id>/extracted_TIMESTAMP/

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”§ TECHNICAL IMPLEMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CLASS STRUCTURE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
class ZipCracker:
    def __init__(zip_path, wordlist_path, results_folder)
    def set_progress_callback(callback)
    def show_progress()              # Progress thread
    def crack()                      # Main cracking function
    def _extract_zip(password)       # Extract with password
    def _generate_report(...)        # Generate report
    def _save_report(content)        # Save report

THREADING:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
self.stop_event = Event()
self.progress_thread = Thread(target=self.show_progress, daemon=True)

# Start
self.progress_thread.start()

# Stop
self.stop_event.set()
self.progress_thread.join(timeout=2)

PROGRESS CALLBACK:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# From progress thread, send to Telegram
asyncio.run_coroutine_threadsafe(
    self.progress_callback(progress_msg),
    asyncio.get_event_loop()
)

CRACKING LOOP:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
with open(wordlist_path, 'r') as wordlist:
    for line in wordlist:
        if self.stop_event.is_set():
            break
        
        password = line.strip()
        self.attempts += 1
        
        try:
            zip_file.setpassword(password.encode('utf-8'))
            zip_file.testzip()
            
            # Password found!
            self.found_password = password
            self.stop_event.set()
            break
        except:
            continue

STATISTICS:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
self.start_time = time.time()
elapsed = time.time() - self.start_time
speed = self.attempts / elapsed

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ USAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

BASIC USAGE:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User: /zip_crack
Bot: "âš ï¸ Warning... Please upload a ZIP file."
User: [uploads file.zip]
Bot: "ğŸ“¥ Downloading file.zip..."
Bot: "ğŸ” Starting ZIP crack..."
Bot: "[+] Attempts: 100 | Time: 5s | Speed: 20.0 pwd/s"
Bot: "[+] Attempts: 500 | Time: 25s | Speed: 20.0 pwd/s"
Bot: "âœ… PASSWORD FOUND! Password: secret123"

WITH SIZE SELECTION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
/zip_crack small   â†’ Uses smallest wordlist
/zip_crack medium  â†’ Uses medium wordlist
/zip_crack big     â†’ Uses largest wordlist (default)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ EXAMPLE OUTPUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TELEGRAM MESSAGES:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Initial:
âš ï¸ This ZIP cracking feature is for educational cybersecurity training 
only, and may only be used on files you own.

ğŸ“¦ Please upload a ZIP file to crack its password.

After upload:
ğŸ“¥ Downloading secret.zip...

Starting crack:
ğŸ” Starting ZIP crack on secret.zip...
Using wordlist: rockyou.txt (14.3 MB)

Progress updates (every 2-3 seconds):
[+] Attempts: 250 | Time: 12s | Speed: 20.8 pwd/s
[+] Attempts: 500 | Time: 24s | Speed: 20.8 pwd/s
[+] Attempts: 750 | Time: 36s | Speed: 20.8 pwd/s

Success:
âœ… PASSWORD FOUND!

File: secret.zip
Password: `password123`
Attempts: 847
Time: 40.7 seconds
Speed: 20.8 passwords/second

Extracted 5 file(s):
  - document.pdf
  - image.jpg
  - data.txt
  - config.ini
  - readme.md

Extract path: results/123456/extracted_20231123_175430/
Report saved: results/123456/zipcrack_report_20231123_175430.txt

Failure:
âŒ PASSWORD NOT FOUND

Tested 10,000 passwords
Time: 8 minutes 20 seconds
Speed: 20.0 passwords/second

Report saved: results/123456/zipcrack_report_20231123_175430.txt

REPORT FILE CONTENT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
============================================================
ZIP PASSWORD CRACKING REPORT
============================================================
Timestamp: 2023-11-23 17:54:30
ZIP File: results/123456/zip/secret.zip
Wordlist: C:/Users/neox/Desktop/Ps/rockyou.txt

RESULTS:
------------------------------------------------------------
âœ… PASSWORD FOUND!
Password: password123
Attempts: 847
Time: 40.72 seconds
Speed: 20.8 passwords/second
Extracted to: results/123456/extracted_20231123_175430/
============================================================

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âš™ï¸ BOT.PY INTEGRATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

UPDATE zip_crack_command:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

async def zip_crack_command(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """ZIP password cracking - AUTHORIZED USE ONLY"""
    warning = ("âš ï¸ **WARNING:** This ZIP cracking feature is for educational "
               "cybersecurity training only, and may only be used on files you own.")
    
    # Check for size argument
    wordlist_size = 'big'  # default
    if context.args and context.args[0].lower() in ['small', 'medium', 'big']:
        wordlist_size = context.args[0].lower()
    
    await update.message.reply_text(
        f"{warning}\n\nğŸ“¦ Please upload a ZIP file to crack its password.",
        parse_mode='Markdown'
    )
    
    # Store user context
    user_data_store[update.effective_user.id] = {
        'awaiting_zip': True,
        'wordlist_size': wordlist_size
    }


async def handle_document(update: Update, context: ContextTypes.DEFAULT_TYPE):
    """Handle uploaded documents (for ZIP cracking)"""
    user_id = update.effective_user.id
    
    if user_id not in user_data_store or not user_data_store[user_id].get('awaiting_zip'):
        return
    
    wordlist_size = user_data_store[user_id].get('wordlist_size', 'big')
    user_data_store[user_id]['awaiting_zip'] = False
    
    document = update.message.document
    
    if not document.file_name.endswith('.zip'):
        await update.message.reply_text("âŒ Please upload a ZIP file (.zip extension)")
        return
    
    msg = await update.message.reply_text(f"ğŸ“¥ Downloading {document.file_name}...")
    
    try:
        # Download file
        file = await context.bot.get_file(document.file_id)
        
        # Create user-specific folder
        user_folder = os.path.join(config.RESULTS_FOLDER, str(user_id), 'zip')
        os.makedirs(user_folder, exist_ok=True)
        
        zip_path = os.path.join(user_folder, document.file_name)
        await file.download_to_drive(zip_path)
        
        await msg.edit_text(f"ğŸ” Starting ZIP crack on {document.file_name}...")
        
        # Progress callback
        async def progress(status):
            try:
                await msg.edit_text(f"ğŸ” ZIP Cracking...\n\n{status}")
            except:
                pass
        
        # Start cracking with auto wordlist selection
        result = await zip_cracker.crack_zip_auto_wordlist(
            zip_path,
            config.WORDLIST_DIR,
            user_folder,
            wordlist_size,
            progress
        )
        
        if result['status'] == 'success':
            if result['found']:
                output = f"âœ… **PASSWORD FOUND!**\n\n"
                output += f"File: {document.file_name}\n"
                output += f"Password: `{result['password']}`\n"
                output += f"Attempts: {result['attempts']}\n"
                output += f"Time: {result['time']:.1f} seconds\n"
                output += f"Speed: {result['speed']:.1f} passwords/second\n\n"
                
                if result.get('extract_path'):
                    # List extracted files
                    try:
                        files = os.listdir(result['extract_path'])
                        output += f"Extracted {len(files)} file(s):\n"
                        for fname in files[:10]:
                            output += f"  - {fname}\n"
                        if len(files) > 10:
                            output += f"  ... and {len(files) - 10} more\n"
                        output += f"\nExtract path: {result['extract_path']}\n"
                    except:
                        pass
                
                if result.get('report_file'):
                    output += f"Report saved: {result['report_file']}"
            else:
                output = f"âŒ **PASSWORD NOT FOUND**\n\n"
                output += f"Tested {result['attempts']} passwords\n"
                output += f"Time: {result['time']:.1f} seconds\n"
                output += f"Speed: {result['speed']:.1f} passwords/second\n\n"
                if result.get('report_file'):
                    output += f"Report saved: {result['report_file']}"
            
            await msg.edit_text(output, parse_mode='Markdown')
        else:
            await msg.edit_text(f"âŒ Error: {result.get('message', 'Unknown error')}")
    
    except Exception as e:
        await msg.edit_text(f"âŒ Error: {str(e)}")

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… TESTING CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[ ] /zip_crack command works
[ ] Bot requests ZIP upload
[ ] ZIP file downloads correctly
[ ] Progress updates appear every 2-3 seconds
[ ] Progress shows: Attempts | Time | Speed
[ ] Password found correctly
[ ] Files extracted successfully
[ ] Report generated
[ ] Thread terminates cleanly
[ ] /zip_crack small uses smallest wordlist
[ ] /zip_crack medium uses medium wordlist
[ ] /zip_crack big uses largest wordlist

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š COMPARISON WITH REFERENCE SCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

REFERENCE SCRIPT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Threading with Event
âœ“ Progress thread
âœ“ show_progress() function
âœ“ Attempts/time/speed tracking
âœ“ pyzipper.AESZipFile
âœ“ Line-by-line wordlist reading
âœ“ Immediate stop when found
âœ“ Clean thread termination

OUR IMPLEMENTATION:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Threading with Event                    â† EXACT MATCH
âœ“ Progress thread                         â† EXACT MATCH
âœ“ show_progress() method                  â† EXACT MATCH
âœ“ Attempts/time/speed tracking            â† EXACT MATCH
âœ“ pyzipper.AESZipFile                     â† EXACT MATCH
âœ“ Line-by-line wordlist reading           â† EXACT MATCH
âœ“ Immediate stop when found               â† EXACT MATCH
âœ“ Clean thread termination                â† EXACT MATCH
âœ“ Telegram integration                    â† ADDED
âœ“ Automatic wordlist selection            â† ADDED
âœ“ File upload handling                    â† ADDED
âœ“ Report generation                       â† ADDED

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ”¥ SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… COMPLETE FEATURE PARITY with reference script
âœ… EXACT threading behavior (Thread + Event)
âœ… EXACT progress tracking (attempts/time/speed)
âœ… EXACT cracking logic (pyzipper + wordlist iteration)
âœ… TELEGRAM integration (progress updates, messages)
âœ… AUTOMATIC wordlist selection (small/medium/big)
âœ… FILE upload handling
âœ… REPORT generation
âœ… NO SIMULATION - real cracking
âœ… CLEAN thread termination
âœ… EDUCATIONAL warning

FILE UPDATED:
âœ… modules/zip_cracker.py (COMPLETELY REWRITTEN)

DOCUMENTATION:
âœ… ZIP_CRACKER_UPGRADED.txt (This file)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”¥ YOUR ZIP CRACKER NOW MATCHES THE REFERENCE SCRIPT EXACTLY!

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
